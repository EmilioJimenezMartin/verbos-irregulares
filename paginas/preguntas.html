<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"  crossorigin="anonymous">
    <script id="listado" type="text/javascript" src="../js/listaVerbos.js"></script>
    <script>
        var listaTotal = devolverVerbos();
        var lista = [];
        var nivel;
        var paso = 0;
        var tabla;
        var posicionInput;
        var estrellasAcertadas;
        var preguntasAcertadas;

        window.onload = function() {
            preguntasAcertadas = 0;
            estrellasAcertadas = localStorage.getItem("acertadas");
            
            if (estrellasAcertadas == null || estrellasAcertadas == undefined) {
                estrellasAcertadas = 0;
            }

            nivel = new URLSearchParams(location.search).get('nivel');
            document.getElementById("titulo").innerHTML = "Nivel: " + nivel;
            tabla = document.getElementById("tabla");
            do {
                const i = Math.floor(Math.random() * listaTotal.length) + 1;
                if (i != undefined && listaTotal[i] != undefined) {
                    lista.push(listaTotal[i]);
                    listaTotal.splice(i, 1)
                }
            }  
            while (lista.length < nivel);
            obtenerPregunta();
        }

        function obtenerPregunta() {
            posicionInput = posicionAleatoria() - 1;
            var celda0 = document.getElementById("celda0");
            var celda1 = document.getElementById("celda1");
            var celda2 = document.getElementById("celda2");

            var inp = document.createElement("input");
            inp.setAttribute("id", "inp");
            var txt1 = document.createElement("p");
            txt1.setAttribute("id", "txt1");
            var txt2 = document.createElement("p");
            txt2.setAttribute("id", "txt2");

            var respuesta = document.getElementById("respuesta");
            respuesta.innerHTML = lista[paso][3];

            if (posicionInput == 0) {
                celda0.appendChild(inp);
                txt1.innerHTML = lista[paso][1];
                celda1.appendChild(txt1);
                txt2.innerHTML = lista[paso][2];
                celda2.appendChild(txt2);
            }
            if (posicionInput == 1) {
                celda1.appendChild(inp);
                txt1.innerHTML = lista[paso][0];
                celda0.appendChild(txt1);
                txt2.innerHTML = lista[paso][2];
                celda2.appendChild(txt2);
            }
            if (posicionInput == 2) {
                celda2.appendChild(inp);
                txt1.innerHTML = lista[paso][0];
                celda0.appendChild(txt1);
                txt2.innerHTML = lista[paso][1];
                celda1.appendChild(txt2);
            }
        }
        
    
        function comprobar() {
            console.log(lista[paso], 'pregunta');
            console.log(lista[paso][posicionInput], 'listaTotal[paso][posicionInput]')
            var value = document.getElementById("inp").value;
            if (value.toLowerCase() == lista[paso][posicionInput]) {
                console.log(true);
                preguntasAcertadas++;
                if (preguntasAcertadas == 10) {
                    estrellasAcertadas++;
                    localStorage.setItem("acertadas", estrellasAcertadas);
                }
            } else {
                console.log(false);
            }
            console.log(value, 'valor de input')
            var celda0 = document.getElementById("celda0");
            celda0.removeChild(celda0.childNodes[0]);
            var celda1 = document.getElementById("celda1");
            celda1.removeChild(celda1.childNodes[0]);
            var celda2 = document.getElementById("celda2");
            celda2.removeChild(celda2.childNodes[0]);
            paso++;
            obtenerPregunta();
        }
    
        function volver() {
            window.location = '../index.html';
        }

        function posicionAleatoria() {
            return Math.floor(Math.random() * 3) + 1;
        }
    </script>
    
</head>

<body>
    <div class="contenedor">
        <div class="header">
            <p id="titulo">Nivel</p>
        </div>
        <!--
        <div class="contenedor-estrellas">
            <div class="stars-outer">
                <div class="stars-inner"></div>
              </div>
        </div>
        -->
        <div class="btn-container">
            <button type="button" class="btn btn-primary" onclick = "comprobar()">Comprueba</button>
            <button type="button" class="btn btn-primary" onclick = "volver()">Cambia de nivel</button>
        </div>
        <div class="tabla-container">
            <div>
                <p id="respuesta"></p>
            </div>
            <div class="tabla row">
                <div id="celda0" class="col-4"></div>
                <div id="celda1" class="col-4"></div>
                <div id="celda2" class="col-4"></div>
            </div>
        </div>
        
    </div>
</body>
</html>